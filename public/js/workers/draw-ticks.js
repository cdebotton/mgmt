// Generated by CoffeeScript 1.4.0
(function() {
  var c, days, dx, getDate, getDay, getMonth, getYear, grid, months, readableDate, ticks;

  ticks = {
    dates: []
  };

  grid = {};

  dx = 0;

  c = 0;

  months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sept', 'Oct', 'Nov', 'Dec'];

  days = ['Mon', 'Tues', 'Wed', 'Thur', 'Fri', 'Sat', 'Sun'];

  readableDate = function(date) {
    return "" + (getDay(date)) + " " + (getMonth(date)) + " " + (getDate(date)) + " " + (getYear(date));
  };

  getDay = function(date) {
    var dayVal;
    dayVal = date.getDay() - 1;
    if (dayVal < 0) {
      dayVal = 6;
    }
    return days[dayVal];
  };

  getMonth = function(date) {
    return months[date.getMonth()];
  };

  getYear = function(date) {
    return date.getFullYear();
  };

  getDate = function(date) {
    return date.getDate();
  };

  self.addEventListener('message', function(e) {
    var d, epoch;
    d = e.data.start;
    while (d <= e.data.end) {
      epoch = d.getTime();
      grid[epoch] = dx;
      dx += e.data.PX_PER_DAY;
      if (c % 7 === 0) {
        ticks.dates.push({
          dx: dx,
          epoch: epoch,
          readable: readableDate(d)
        });
      }
      c++;
      d.setDate(d.getDate() + 1);
    }
    return self.postMessage({
      grid: grid,
      ticks: ticks
    });
  }, false);

}).call(this);
